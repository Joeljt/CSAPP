## 并发编程

### 基于进程

服务端在接收到每个客户端响应时，直接 fork 一个子进程为其提供响应，C/S 通过新进程的 socket 进行通信，进程隔离使得多个连接彼此之间不受影响。

但同样是进程隔离导致某些必要的通信变得很麻烦，需要引入额外的 IPC 机制来实现。

### 基于 I/O 多路复用

把每个客户端和服务端交互的过程抽象成状态机：输入事件、输入状态、响应状态变更（变更状态或者某个行为）。

基于 I/O 多路复用的 echo 服务器会给每个客户端创建一个新的状态机：

1. 状态：等待客户端 k 变为可读状态；
2. 事件：客户端 k 可读；
3. 响应：读取并 echo 给客户端 k；

相较于基于进程的并发编程，I/O 多路复用可以：

1. 开发者拥有更多的控制权，因为整个程序都是同一个进程，代码逻辑都是线性的，开发者可以访问整个内存空间，也不需要关心进程间通信的问题；
2. 代码执行效率更多，因为省去了很多上下文切换的开销；

但同时也带来了一些劣势：

1. 复杂度上升，因为要在同一个进程中处理所有情况，所以代码量会显著增加；
2. 单一进程无法高效利用现代计算机的多核心；

